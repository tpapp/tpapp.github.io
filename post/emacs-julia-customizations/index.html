<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>Emacs customizations for julia-mode</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.69.2" />
    <link rel="stylesheet" type="text/css" href="../../css/style.css">
    <link rel="stylesheet" type="text/css" href="../../css/syntax.css">
    
    <link href="https://fonts.googleapis.com/css?family=Noto+Serif:400,400i,700,700i|Ubuntu+Mono&display=swap&subset=latin-ext" rel="stylesheet"> 
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          
          
          processEscapes: true,
          processEnvironments: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
          TeX: { equationNumbers: { autoNumber: "AMS" },
          extensions: ["AMSmath.js", "AMSsymbols.js"] }
          },
        CommonHTML: { linebreaks: { automatic: true } },
        "HTML-CSS": { linebreaks: { automatic: true } },
        SVG: { linebreaks: { automatic: true } }
      });
    </script>
    <script type="text/javascript" async
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>
  <body>
    <nav id="navbar">
      <a href="https://tamaspapp.eu/">About</a>
<a href="https://tamaspapp.eu/research">Research</a>
<a href="https://tamaspapp.eu/teaching">Teaching</a>
<a href="https://tamaspapp.eu/post">Blog</a>
<a href="https://github.com/tpapp/">Github</a>
<div class="dropdown">
  <a class="dropdown-button">(tags)</a>
  <div class="dropdown-content">
    <p class="dropdown-header">site tags</p>
    
    <a href="../../tags/automatic-differentiation">automatic-differentiation</a>
    
    <a href="../../tags/bayesian">bayesian</a>
    
    <a href="../../tags/big-data">big-data</a>
    
    <a href="../../tags/blogging">blogging</a>
    
    <a href="../../tags/browser-plugins">browser-plugins</a>
    
    <a href="../../tags/coverage">coverage</a>
    
    <a href="../../tags/docker">docker</a>
    
    <a href="../../tags/emacs">emacs</a>
    
    <a href="../../tags/emacs25">emacs25</a>
    
    <a href="../../tags/firefox">firefox</a>
    
    <a href="../../tags/forwarddiff">forwarddiff</a>
    
    <a href="../../tags/gitlab">gitlab</a>
    
    <a href="../../tags/hugo">hugo</a>
    
    <a href="../../tags/indirect-inference">indirect-inference</a>
    
    <a href="../../tags/jacobian">jacobian</a>
    
    <a href="../../tags/julia">julia</a>
    
    <a href="../../tags/julia-repl">julia-repl</a>
    
    <a href="../../tags/latex">latex</a>
    
    <a href="../../tags/lisp">lisp</a>
    
    <a href="../../tags/log1p">log1p</a>
    
    <a href="../../tags/magit">magit</a>
    
    <a href="../../tags/math">math</a>
    
    <a href="../../tags/mcmc">mcmc</a>
    
    <a href="../../tags/microoptimization">microoptimization</a>
    
    <a href="../../tags/numerical-error">numerical-error</a>
    
    <a href="../../tags/packages">packages</a>
    
    <a href="../../tags/plots">plots</a>
    
    <a href="../../tags/stan">stan</a>
    
    <a href="../../tags/teaching">teaching</a>
    
    <a href="../../tags/ubuntu">ubuntu</a>
    
    <a href="../../tags/unit-testing">unit-testing</a>
    
    <a href="../../tags/weave">weave</a>
    
  </div>
</div>
<a href="https://tamaspapp.eu/post/index.xml" type="application/rss+xml" target="_blank"><img class="feedicon" src="https://tamaspapp.eu/img/feed-icon.svg" alt="Atom feed (blog)" title="Atom feed (blog)"></a>

    </nav>
    <div id="navbarplaceholder">
      <a href="https://tamaspapp.eu/">About</a>
<a href="https://tamaspapp.eu/research">Research</a>
<a href="https://tamaspapp.eu/teaching">Teaching</a>
<a href="https://tamaspapp.eu/post">Blog</a>
<a href="https://github.com/tpapp/">Github</a>
<div class="dropdown">
  <a class="dropdown-button">(tags)</a>
  <div class="dropdown-content">
    <p class="dropdown-header">site tags</p>
    
    <a href="../../tags/automatic-differentiation">automatic-differentiation</a>
    
    <a href="../../tags/bayesian">bayesian</a>
    
    <a href="../../tags/big-data">big-data</a>
    
    <a href="../../tags/blogging">blogging</a>
    
    <a href="../../tags/browser-plugins">browser-plugins</a>
    
    <a href="../../tags/coverage">coverage</a>
    
    <a href="../../tags/docker">docker</a>
    
    <a href="../../tags/emacs">emacs</a>
    
    <a href="../../tags/emacs25">emacs25</a>
    
    <a href="../../tags/firefox">firefox</a>
    
    <a href="../../tags/forwarddiff">forwarddiff</a>
    
    <a href="../../tags/gitlab">gitlab</a>
    
    <a href="../../tags/hugo">hugo</a>
    
    <a href="../../tags/indirect-inference">indirect-inference</a>
    
    <a href="../../tags/jacobian">jacobian</a>
    
    <a href="../../tags/julia">julia</a>
    
    <a href="../../tags/julia-repl">julia-repl</a>
    
    <a href="../../tags/latex">latex</a>
    
    <a href="../../tags/lisp">lisp</a>
    
    <a href="../../tags/log1p">log1p</a>
    
    <a href="../../tags/magit">magit</a>
    
    <a href="../../tags/math">math</a>
    
    <a href="../../tags/mcmc">mcmc</a>
    
    <a href="../../tags/microoptimization">microoptimization</a>
    
    <a href="../../tags/numerical-error">numerical-error</a>
    
    <a href="../../tags/packages">packages</a>
    
    <a href="../../tags/plots">plots</a>
    
    <a href="../../tags/stan">stan</a>
    
    <a href="../../tags/teaching">teaching</a>
    
    <a href="../../tags/ubuntu">ubuntu</a>
    
    <a href="../../tags/unit-testing">unit-testing</a>
    
    <a href="../../tags/weave">weave</a>
    
  </div>
</div>
<a href="https://tamaspapp.eu/post/index.xml" type="application/rss+xml" target="_blank"><img class="feedicon" src="https://tamaspapp.eu/img/feed-icon.svg" alt="Atom feed (blog)" title="Atom feed (blog)"></a>

    </div>
    <div id="mainbody">

<div id="content">
<h1>Emacs customizations for julia-mode</h1>2017/08/28
<span class="tags">
    
    <a href="../../tags/julia">julia</a>
    
    <a href="../../tags/emacs">emacs</a>
    
</span>




<div id="pagenav">
  
  <span class="pagenav-label">previous post:</span>&nbsp;
  <a href="https://tamaspapp.eu/post/julia-local-test/">Local packages in a separate directory in Julia</a>
  
  
  
  <br/>
  
  <span class="pagenav-label">next post:</span>&nbsp;
  <a href="https://tamaspapp.eu/post/log1p/">log1p in Julia</a>
  
</div>


<p>I find the following customizations very useful for <em>editing</em> Julia
code in Emacs. Add them to <code>julia-mode-hook</code>, eg</p>
<div class="highlight"><pre class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">defun</span> <span class="nv">customize-julia-mode</span> <span class="p">()</span>
  <span class="s">&#34;Customize julia-mode.&#34;</span>
  <span class="p">(</span><span class="nb">interactive</span><span class="p">)</span>
  <span class="c1">;; my customizations go here</span>
  <span class="p">)</span>

<span class="p">(</span><span class="nv">add-hook</span> <span class="ss">&#39;julia-mode-hook</span> <span class="ss">&#39;customize-julia-mode</span><span class="p">)</span>
</code></pre></div><h2 id="highlight-fixmetodo">Highlight FIXME/TODO/&hellip;</h2>
<p>When I just want to note something in a comment for future reference,
I prefer to have certain words highlighted. You can use something like
this:</p>
<div class="highlight"><pre class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">font-lock-add-keywords</span> <span class="no">nil</span>
                        <span class="o">&#39;</span><span class="p">((</span><span class="s">&#34;\\&lt;\\(FIXME\\|TODO\\|QUESTION\\|NOTE\\)&#34;</span>
                        <span class="mi">1</span> <span class="nv">font-lock-warning-face</span> <span class="no">t</span><span class="p">)))</span>
</code></pre></div><p>This is what it looks like:</p>
<pre style="color: #262626; background-color: #ded6c5;">
            chklapackerror<span style="color: #262626;">(</span>info<span style="color: #262626;">[])</span>
            <span style="color: #2020cc; font-weight: bold;">if</span> any<span style="color: #262626;">(</span>ifail .!= 0<span style="color: #262626;">)</span>
                <span style="color: #008b45;"># </span><span style="color: #f71010; font-weight: bold;">TODO</span><span style="color: #008b45;">: better error message / type
</span>                error<span style="color: #262626;">(</span><span style="color: #fa5151;">"failed to converge eigenvectors:\n$(nonzeros(ifail))"</span><span style="color: #262626;">)</span>
            <span style="color: #2020cc; font-weight: bold;">end</span>
</pre>
<h2 id="highlight-symbols">Highlight symbols</h2>
<p>After</p>
<div class="highlight"><pre class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">require</span> <span class="ss">&#39;highlight-symbol</span><span class="p">)</span>
</code></pre></div><p>add a hook for</p>
<div class="highlight"><pre class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">local-set-key</span> <span class="p">[(</span><span class="nv">control</span> <span class="sc">?c</span><span class="p">)</span> <span class="sc">?s</span><span class="p">]</span> <span class="ss">&#39;highlight-symbol-at-point</span><span class="p">)</span>
<span class="p">(</span><span class="nv">local-set-key</span> <span class="p">[(</span><span class="nv">control</span> <span class="sc">?c</span><span class="p">)</span> <span class="sc">?n</span><span class="p">]</span> <span class="ss">&#39;highlight-symbol-next</span><span class="p">)</span>
<span class="p">(</span><span class="nv">local-set-key</span> <span class="p">[(</span><span class="nv">control</span> <span class="sc">?c</span><span class="p">)</span> <span class="sc">?p</span><span class="p">]</span> <span class="ss">&#39;highlight-symbol-prev</span><span class="p">)</span>
</code></pre></div><p>This highlights symbols with <code>C-c s</code>:</p>
<pre style="color: #262626; background-color: #ded6c5;">
<span style="color: #2020cc; font-weight: bold;">function</span> <span style="color: #2c53ca;">issymmetric</span><span style="color: #262626;">(</span><span style="color: #000000; background-color: #ffff00;">A</span><span style="color: #262626; background-color: #ded6c5;">::</span><span style="color: #9400d3;">AbstractMatrix</span><span style="color: #262626;">)</span>
    indsm, indsn = indices<span style="color: #262626;">(</span><span style="color: #000000; background-color: #ffff00;">A</span><span style="color: #262626;">)</span>
    <span style="color: #2020cc; font-weight: bold;">if</span> indsm != indsn
        <span style="color: #2020cc; font-weight: bold;">return</span> <span style="color: #259ea2;">false</span>
    <span style="color: #2020cc; font-weight: bold;">end</span>
    <span style="color: #2020cc; font-weight: bold;">for</span> i = first<span style="color: #262626;">(</span>indsn<span style="color: #262626;">)</span>:last<span style="color: #262626;">(</span>indsn<span style="color: #262626;">)</span>, j = <span style="color: #262626;">(</span>i<span style="color: #262626;">)</span>:last<span style="color: #262626;">(</span>indsn<span style="color: #262626;">)</span>
        <span style="color: #2020cc; font-weight: bold;">if</span> <span style="color: #000000; background-color: #ffff00;">A</span><span style="color: #262626;">[</span>i,j<span style="color: #262626;">]</span> != transpose<span style="color: #262626;">(</span><span style="color: #000000; background-color: #ffff00;">A</span><span style="color: #262626;">[</span>j,i<span style="color: #262626;">])</span>
            <span style="color: #2020cc; font-weight: bold;">return</span> <span style="color: #259ea2;">false</span>
        <span style="color: #2020cc; font-weight: bold;">end</span>
    <span style="color: #2020cc; font-weight: bold;">end</span>
    <span style="color: #2020cc; font-weight: bold;">return</span> <span style="color: #259ea2;">true</span>
<span style="color: #2020cc; font-weight: bold;">end</span>
</pre>
<h2 id="fill-docstrings">Fill docstrings</h2>
<p>This is useful if you want to use <code>M-q</code> on docstrings.</p>
<div class="highlight"><pre class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">defun</span> <span class="nv">julia-fill-string</span> <span class="p">()</span>
  <span class="s">&#34;Fill a docstring, preserving newlines before and after triple quotation marks.&#34;</span>
  <span class="p">(</span><span class="nb">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">if</span> <span class="p">(</span><span class="nb">and</span> <span class="nv">transient-mark-mode</span> <span class="nv">mark-active</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">fill-region</span> <span class="p">(</span><span class="nf">region-beginning</span><span class="p">)</span> <span class="p">(</span><span class="nf">region-end</span><span class="p">)</span> <span class="no">nil</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cl-flet</span> <span class="p">((</span><span class="nv">fill-if-string</span> <span class="p">()</span>
                              <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nf">looking-at</span> <span class="p">(</span><span class="nb">rx</span> <span class="s">&#34;\&#34;\&#34;\&#34;&#34;</span>
                                                        <span class="p">(</span><span class="nv">group</span>
                                                         <span class="p">(</span><span class="nv">*?</span> <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nv">not</span> <span class="p">(</span><span class="nv">any</span> <span class="s">&#34;\\&#34;</span><span class="p">))</span>
                                                                 <span class="p">(</span><span class="nv">seq</span> <span class="s">&#34;\\&#34;</span> <span class="nv">anything</span><span class="p">))))</span>
                                                        <span class="s">&#34;\&#34;\&#34;\&#34;&#34;</span><span class="p">))</span>
                                        <span class="p">(</span><span class="nf">looking-at</span> <span class="p">(</span><span class="nb">rx</span> <span class="s">&#34;\&#34;&#34;</span>
                                                        <span class="p">(</span><span class="nv">group</span>
                                                         <span class="p">(</span><span class="nv">*?</span> <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nv">not</span> <span class="p">(</span><span class="nv">any</span> <span class="s">&#34;\\&#34;</span><span class="p">))</span>
                                                                 <span class="p">(</span><span class="nv">seq</span> <span class="s">&#34;\\&#34;</span> <span class="nv">anything</span><span class="p">))))</span>
                                                        <span class="s">&#34;\&#34;&#34;</span><span class="p">)))</span>
                                <span class="p">(</span><span class="nb">let</span> <span class="p">((</span><span class="nv">start</span> <span class="p">(</span><span class="nf">match-beginning</span> <span class="mi">1</span><span class="p">))</span>
                                      <span class="p">(</span><span class="nv">end</span> <span class="p">(</span><span class="nf">match-end</span> <span class="mi">1</span><span class="p">)))</span>
                                  <span class="c1">;; (ess-blink-region start end)</span>
                                  <span class="p">(</span><span class="nv">fill-region</span> <span class="nv">start</span> <span class="nv">end</span> <span class="no">nil</span> <span class="no">nil</span> <span class="no">nil</span><span class="p">)))))</span>
      <span class="p">(</span><span class="nb">save-excursion</span>
        <span class="p">(</span><span class="nb">let</span> <span class="p">((</span><span class="nv">s</span> <span class="p">(</span><span class="nv">syntax-ppss</span><span class="p">)))</span>
          <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">fourth</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nv">ninth</span> <span class="nv">s</span><span class="p">))))</span>
        <span class="p">(</span><span class="nv">fill-if-string</span><span class="p">)))))</span>
</code></pre></div><p>Add</p>
<div class="highlight"><pre class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">local-set-key</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">&#34;M-q&#34;</span><span class="p">)</span> <span class="ss">&#39;julia-fill-string</span><span class="p">)</span>
</code></pre></div><p>to the mode hook.</p>
<h2 id="highlight-things-after-column-80">Highlight things after column 80</h2>
<p>I add this to the mode hook:</p>
<div class="highlight"><pre class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">set-fill-column</span> <span class="mi">80</span><span class="p">)</span>
</code></pre></div><p>I also use <code>whitespace</code> globally:</p>
<div class="highlight"><pre class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">require</span> <span class="ss">&#39;whitespace</span><span class="p">)</span>
<span class="p">(</span><span class="nb">setq</span> <span class="nv">whitespace-style</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">face</span> <span class="nv">empty</span> <span class="nv">tabs</span> <span class="nv">lines-tail</span> <span class="nv">trailing</span><span class="p">))</span>
<span class="p">(</span><span class="nv">global-whitespace-mode</span> <span class="no">t</span><span class="p">)</span>
</code></pre></div><p>This is what it looks like:</p>
<pre style="color: #262626; background-color: #ded6c5;">
    QR<span style="color: #262626;">{</span>T,S<span style="color: #262626;">}(</span>factors<span style="color: #262626; background-color: #ded6c5;">::</span><span style="color: #9400d3;">AbstractMatrix</span><span style="color: #262626;">{</span>T<span style="color: #262626;">}</span>, &#964;<span style="color: #262626; background-color: #ded6c5;">::</span><span style="color: #9400d3;">Vector</span><span style="color: #262626;">{</span>T<span style="color: #262626;">})</span> where <span style="color: #262626;">{</span>T,S<span style="color: #262626; background-color: #ded6c5;">&lt;:</span><span style="color: #9400d3;">AbstractMatrix</span><span style="color: #262626; background-color: #f6f0e1;">}</span><span style="background-color: #f6f0e1;"> = new</span><span style="color: #262626; background-color: #f6f0e1;">(</span><span style="background-color: #f6f0e1;">factors, &#964;</span><span style="color: #262626; background-color: #f6f0e1;">)</span>
<span style="color: #2020cc; font-weight: bold;">end</span>
QR<span style="color: #262626;">(</span>factors<span style="color: #262626; background-color: #ded6c5;">::</span><span style="color: #9400d3;">AbstractMatrix</span><span style="color: #262626;">{</span>T<span style="color: #262626;">}</span>, &#964;<span style="color: #262626; background-color: #ded6c5;">::</span><span style="color: #9400d3;">Vector</span><span style="color: #262626;">{</span>T<span style="color: #262626;">})</span> where <span style="color: #262626;">{</span>T<span style="color: #262626;">}</span> = QR<span style="color: #262626;">{</span>T,typeof<span style="color: #262626;">(</span>factors<span style="color: #262626;">)}(</span>f<span style="background-color: #f6f0e1;">actors, &#964;</span><span style="color: #262626; background-color: #f6f0e1;">)</span>
</pre>
<h2 id="hungry-delete-mode">Hungry delete-mode</h2>
<p>Add this to the mode hook:</p>
<div class="highlight"><pre class="chroma"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">hungry-delete-mode</span><span class="p">)</span>
</code></pre></div><p>and then backspace and delete will remove all whitespace near the point in the relevant direction.</p>
<p>In case you are wondering, the theme is <a href="https://github.com/alezost/alect-themes">alect-light</a>.</p>


</div>

<script src="https://utteranc.es/client.js"
        repo="tpapp/tpapp.github.io"
        issue-term="pathname"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

    </div>
    <div id="smallscreenwarning">
      site not optimized for small screens, math may break
    </div>
  </body>
</html>

